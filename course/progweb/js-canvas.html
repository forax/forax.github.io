<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>JavaScript - Canvas API</title>

		<meta name="description" content="JavaScript, Canvas API">
		<meta name="author" content="Remi Forax">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
		
		<!-- autojs result -->
		<style>
		  canvas {
		    background-color: white;
		  }
		  div.autojslog {
		    color: orange;
		  }
		  div.autojserror {
		    color: red;
		  }
		  .bad-container {
            position: relative;
            display:inline-block;
          }
		  .bad-image:after {
            content: url(images/js/bad.png);
            position: absolute;
            z-index: 9999;
            right: 5px;
            bottom: 0px;
          }
		</style>
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
                                <section>
					<h1>JavaScript</h1>
                                       <br/>
                                        <h2>Canvas API</h2>
					<p>
					  Remi Forax
					</p>
				</section>
				<section>
                                        <h2>Canvas API ?</h2>
					<blockquote cite="https://en.wikipedia.org/wiki/Array_data_structure">
					  &ldquo;The canvas element is part of HTML5 and allows for dynamic, scriptable rendering of 2D shapes and bitmap images.
					  It is a low level, procedural model that updates a bitmap.&rdquo;
					</blockquote>
                                        <p align="right">
                                         source: Wikipedia.org - <a href="https://en.wikipedia.org/wiki/Canvas_element">Canvas Element</a>
                                        </p>
				</section>
                <section>
                                        <h2>API des Canvas ?</h2>
					<blockquote cite="https://en.wikipedia.org/wiki/Array_data_structure">
					  &ldquo;L'élément canvas est une partie du HTML5 et permet d'afficher dynamiquement avec un script des figures 2D et des images bitmap.
					  C'est un modèle procédural de bas niveau qui met à jour une image.&rdquo;
					</blockquote>
                                        <p align="right">
                                         source : Wikipedia.org - <a href="https://en.wikipedia.org/wiki/Canvas_element">L'élément Canvas</a>
                                        </p>
				</section>
				<section>
					<h2>Historique des versions</h2>
					
					 La spécification est en 2 parties
					<br/>
					 <ol>
					  <li>un élément <em>canvas</em></li>
					  <li>un objet <em>context&nbsp;2D</em></li>
					 </ol>
					<p>&nbsp</p>
					<table>
                                         <tr>
                                          <td><a href="https://www.w3.org/TR/html5/scripting-1.html#the-canvas-element">HTML 5 Canvas</a></td><td>2014</td>
                                         </tr><tr>
                                          <td><a href="https://www.w3.org/TR/2dcontext/">Context 2D</a></td><td>2015</td>
                                         </tr>
                                        </table>
                                    
				</section>
                <section>
                    <h2>Un Canvas</h2>
                    <p>
                        Déclaré avec la balise &ltcanvas&gt;
                    </p>
                    <pre><code class="html" data-trim>
&lt;canvas id="canvas-id"
        width="250"
        height="180"&gt;&lt;/canvas&gt;
                                        </code></pre>
                    <canvas id="canvas-id"
                            width="250"
                            height="180">
                    </canvas>
                    <p>
                        accessible en Javascript avec <tt>getElementById</tt>
                    </p>
                    <small><textarea autojscanvas="canvas-id" rows="2" cols="60">
let canvas = document.getElementById("canvas-id");
                                        </textarea></small>
                </section>
                <section>
                    <h2>document.getElementById()</h2>
                    <p>
                        L'arbre DOM correspondant au canvas doit avoir été créé au moment
                        de l'appel à <tt>document.getElementById()</tt>
                    </p>
                    <p>&nbsp;</p>
                    <pre><code>
&lt;script&gt;
  let canvas = document.getElementById("canvas-id");
  // canvas == null
&lt;/script&gt;
&lt;canvas id="canvas-id"&gt;&lt;/canvas&gt;
                    </code></pre>
                    <p> </p>
                    <p>
                    <p>
                        Sinon <tt>document.getElementById()</tt> renvoie <tt>null</tt>
                    </p>
                    </p>
                </section>
                <section>
                    <h2>window.onload</h2>
                    <p>
                        permet enregistrer une fonction qui sera appelée une fois que
                        le document HTML est chargé
                    </p>
                    <pre><code>
&lt;script&gt;
  window.onload = () => {
    let canvas = document.getElementById("canvas-id");
    // canvas != null
  };
&lt;/script&gt;
&lt;canvas id="canvas-id"&gt;&lt;/canvas&gt;
                    </code></pre>
                    <p> </p>
                    <p>
                        window.onload() est appelée après que le canvas a été créé
                    </p>
                </section>

                                <section>
					                    <h2>L'API Canvas</h2>
					                    <p>
                                         permet de dessiner avec JavaScript sur un canvas HTML
                                         </p>
                                        <p>&nbsp;</p>
                                        <pre><code class="html" data-trim>
&lt;canvas id="canvas-example1"
        width="250"
        height="180"&gt;&lt;/canvas&gt;
                                        </code></pre>
                                        <canvas id="canvas-example1"
                                                width="250"
                                                height="180">
                                        </canvas>
                                        <small><textarea autojscanvas="canvas-example1" rows="6" cols="60">
let canvas = document.getElementById("canvas-example1");
let context = canvas.getContext("2d");

context.strokeRect(50, 25, 75, 35);
context.strokeRect(75, 50, 100, 60);
                                        </textarea></small>
				                </section>
				                
				                <section>
					                    <h2>Le context 2D</h2>
					                    <p>
                                         On récupère l'élément Canvas par son nom
                                        <br/>
                                         puis on demande le contexte de dessin 2D pour dessiner.
                                         </p>
                                        <p>&nbsp;</p>
                                        <canvas id="canvas-example2"
                                                width="300"
                                                height="180">
                                        </canvas>
                                        <small><textarea autojscanvas="canvas-example2" rows="6" cols="60">
let canvas = document.getElementById('canvas-example2');
let context = canvas.getContext("2d");

context.fillStyle = "tomato";
context.fillRect(100, 50, 100, 100);
                                        </textarea></small>
                                        <p><small>
                                         Il existe aussi un context 3D, défini par la specification
                                         <a href="https://www.khronos.org/registry/webgl/specs/latest/">WebGL</a>.
                                        </small></p>
				                </section>
				                
				                <section>
					                    <h2>Les coordonnées</h2>
					                    <p>
                                         Le point (x=0, y=0) est en haut à gauche
                                        </p><p><small>
                                         x : coordonnée sur l'axe horizontal (vers la droite)
                                        <br/>
                                         y : coordonnée sur l'axe vertical (vers le bas)
                                        </small></p>
                                        <canvas id="canvas-example3"
                                                width="300"
                                                height="180">
                                        </canvas>
                                        <small><textarea autojscanvas="canvas-example3" rows="6" cols="60">
let canvas = document.getElementById('canvas-example3');
let context = canvas.getContext("2d");

context.fillStyle = "violet";
context.fillRect(0, 0, 100, 100);
                                        </textarea></small>
                                        <p>&nbsp;</p>
				                </section>

                                <section>
					                    <h2>L'état du context</h2>
					                    <p>
					                     La façon d'afficher dépend de l'état de propriétés du context
					                    </p>
                                        <p></p>
                                        <canvas id="canvas-example4"
                                                width="300"
                                                height="180">
                                        </canvas>
                                        <p></p>
                                        <small><textarea autojscanvas="canvas-example4" rows="6" cols="40">
context.strokeStyle = "blue";
context.strokeRect(150, 25, 100, 100);
 
context.strokeStyle = "red";
context.strokeRect(100, 50, 100, 100);    
                                        </textarea></small>
                                        <p>
                                         Par exemple, l'affichage de la couleur d'un rectangle dépend
					                     de la propriété <b>stokeStyle</b>
                                        </p>
                                     
				                </section>
				                <section>
					                    <h2>Couleur</h2>
					                    <p>
					                     Les couleurs sont les mêmes que les <a href="css.html#style-color">couleurs de CSS</a>
					                    </p>
                                        <p></p>
                                        <canvas id="canvas-color"
                                                width="300"
                                                height="180">
                                        </canvas>
                                        <p></p>
                                        <small><textarea autojscanvas="canvas-color" rows="6" cols="40">
context.fillStyle = "rgb(255, 0, 0)";
context.fillRect(25, 50, 100, 100);

context.fillStyle = "#00A0A0";
context.fillRect(150, 50, 100, 100);
                                        </textarea></small>
                                        <p></p>
                                     
				                </section>
				                <section>
					                    <h2>Gradient linéaire</h2>
					                    <p>
					                     On définit un gradient linéaire par deux points (x1,&nbsp;y1) (x2,&nbsp;y2)
					                     puis plusieurs couleurs (<em>color stops</em>) sur une échelle entre 0 et 1
					                    </p>
                                        <div style="float: left">
                                        <canvas id="canvas-color2"
                                                width="250"
                                                height="250">
                                        </canvas>
                                        </div><div>
                                        <small><textarea autojscanvas="canvas-color2" rows="9" cols="50">
let gradient = context.createLinearGradient(
                   50, 50,
                   200, 200);
gradient.addColorStop(0, "rgb(255, 0, 0)");
gradient.addColorStop(0.75, "white");
gradient.addColorStop(1, "blue");
context.fillStyle = gradient;
context.fillRect(50, 50, 150, 150);
                                        </textarea></small>
                                        </div>
                                        <p style="clear: both"></p>
                                     
				                </section>
				                <section>
					                    <h2>Gradient circulaire</h2>
					                    <p>
					                     On définit un gradient circulaire par 2 cercles (x1,&nbsp;y1,&nbsp;r1) (x2,&nbsp;y2,&nbsp;r2)
					                    </p>
                                        <div style="float: left">
                                        <canvas id="canvas-color3"
                                                width="250"
                                                height="250">
                                        </canvas>
                                        </div><div>
                                        <small><textarea autojscanvas="canvas-color3" rows="9" cols="50">
let gradient = context.createRadialGradient(
                   125, 125, 10,
                   130, 130, 30);
gradient.addColorStop(0, "#A0FF00");
gradient.addColorStop(0.75, "#00A064");
gradient.addColorStop(1, "#00A064");
context.fillStyle = gradient;
context.fillRect(50, 50, 150, 150);
                                        </textarea></small>
                                        </div>
                                        <p style="clear: both"></p>
                                     
				                </section>
				                
				                <section>
				                        <h2>opérations sur un canvas</h2>
				                        <ul>
				                         <li>Afficher un texte</li>
				                         <li>Afficher une figure simple</li>
				                         <li>Afficher des figures complexes</li>
				                         <li>Afficher une image</li>
				                         <li>Gestion des évènements</li>
				                        </ul>
				                </section>
				                
				                
				                <section>
					                    <h2>Afficher un texte</h2>
					                    <p>
					                     <em>stroke</em> = trait
					                    <br/>
					                     <em>fill</em> = remplissage
					                    </p>
                                        <p></p>
                                        <canvas id="canvas-text"
                                                width="300"
                                                height="180">
                                        </canvas>
                                        <p></p>
                                        <small><textarea autojscanvas="canvas-text" rows="6" cols="40">
context.strokeStyle = "gray";
context.fillStyle = "red";                                        
context.font = "40px Arial";
context.strokeText("Hello World", 20, 50);   
context.fillText("Hello World", 20, 100);  
                                        </textarea></small>
                                        <p><small>
                                         On peut faire des effets d'ombre en dessinant avec un décalage d'1 ou 2 pixels
                                        </small></p>
				                </section>
				                <section>
					                    <h2>Afficher un rectangle</h2>
					                    <p>
					                     <em>stroke</em> = trait
					                    <br/>
					                     <em>fill</em> = remplissage
					                    </p>
                                        <p></p>
                                        <canvas id="canvas-rect"
                                                width="300"
                                                height="180">
                                        </canvas>
                                        <p></p>
                                        <small><textarea autojscanvas="canvas-rect" rows="6" cols="45">
context.strokeStyle = "blue";                                    
context.strokeRect(50, 50, 100, 50);

context.fillStyle = "red";
context.fillRect(100, 75, 100, 50);
                                        </textarea></small>
                                        <p></p>
				                </section>
				                
				                <section>
					                    <h2>Afficher une ligne</h2>
					                    <p>
					                     <b>moveTo</b> déplace le crayon, <b>lineTo</b> place une ligne,
					                    <br/>
					                     <b>beginPath</b> indique le début d'un chemin, <b>stroke</b> dessine
					                    </p>
                                        <p></p>
                                        <canvas id="canvas-line"
                                                width="300"
                                                height="180">
                                        </canvas>
                                        <p></p>
                                        <small><textarea autojscanvas="canvas-line" rows="9" cols="40">
context.strokeStyle = "orange";
context.lineWidth = 7;     
                        
context.beginPath();       
context.moveTo(50, 50);
context.lineTo(150, 150);
context.lineTo(250, 50);
context.stroke();
                                        </textarea></small>
                                        <p></p>
				                </section>
				                <section>
					                    <h2>Style d'une ligne</h2>
					                    <p></p>
                                        <canvas id="canvas-line2"
                                                width="300"
                                                height="180">
                                        </canvas>
                                        <p></p>
                                        <small><textarea autojscanvas="canvas-line2" rows="11" cols="30">
context.strokeStyle = "fuchsia";
context.lineWidth = 7;     
context.lineCap = "round";
context.lineJoin = "bevel"; 
 
context.beginPath();
context.moveTo(50, 50);
context.lineTo(150, 150);
context.lineTo(250, 50);
context.stroke();
                                        </textarea></small>
					                    <small><dl style="float: right">
					                     <dt>lineWith</dt>
					                     <dd>épaisseur du trait</dd>
					                     <dt>lineCap: butt | round | square</dt>
					                     <dd>bout des lignes</dd>
					                     <dt>lineJoin: bevel | round | miter</dt>
					                     <dd>jointure entre les lignes</dd>
					                    </dl></small>
                                        <p style="clear: both"></p>
				                </section>
				                
				                <section>
					                    <h2>Afficher un cercle/ellipse</h2>
					                    <p>
					                     arc(x, y, radius, startAngle, endAngle)
					                    <br/>
					                     <small>les angles sont en radians !</small>
					                    </p>
                                        <p></p>
                                        <canvas id="canvas-arc"
                                                width="300"
                                                height="180">
                                        </canvas>
                                        <p></p>
                                        <small><textarea autojscanvas="canvas-arc" rows="8" cols="60">
context.font = "14px arial";
for(let i = 0; i < 4; i++) {
  context.strokeText((i + 1) + " PI / 2", 85 + 50 * i, 27 + 45 * i);
  context.beginPath();
  context.arc(50 + 50 * i, 20 + 45 * i, 20, 0, (i + 1) * Math.PI / 2);
  context.stroke();
}
                                        </textarea></small>
                                        <p><small>
                                         Le point d'angle 0 est au centre à droite et on tourne dans le sens des aiguilles d'une montre
                                        </small></p>
				                </section>
				                
				                <!-- section>
					                    <h2>Tableau de pixels</h2>
					                    <p>
					                     getImageData() renvoie un tableau de pixels
					                    </p>
                                        <canvas id="canvas-image-data"
                                                style="float: left"
                                                width="250"
                                                height="180">
                                        </canvas>
                                        <p>
                                        <small><textarea autojscanvas="canvas-image-data" rows="14" cols="55">
let imageData = context.getImageData(0, 0,
                                                           canvas.width, canvas.height);
let array = imageData.data;
for(let y = 0; y < canvas.height; y++) {
  for(let x = 0; x < canvas.width; x++) {
    let i = (x + y * canvas.width) * 4;
    array[i]   = Math.floor(255 * x / canvas.width);      // red
    array[i+1] = 128;                                                              // green
    array[i+2] = Math.floor(255 * y / canvas.height);  // blue
    array[i+3] = 255;                                                              // alpha
  }
}
context.putImageData(imageData, 0, 0);
                                        </textarea></small>
                                        </p> 
                                        <p><small>
                                         Chaque pixel est composé d'une case rouge, verte, bleue, alpha
                                        </small></p>
				                </section>
				                <section>
					                    <h2>Tableau de pixels (2)</h2>
					                    <p>
					                     putImageData() copie le tableau de pixels dans le canvas.
					                    </p>
                                        <canvas id="canvas-image-data2"
                                                style="float: left"
                                                width="250"
                                                height="180">
                                        </canvas>
                                        <p>
                                        <small><textarea autojscanvas="canvas-image-data2" rows="13" cols="55">
let imageData = context.getImageData(0, 0,
                                                           canvas.width, canvas.height);
let array = imageData.data;
for(let i = 0; i < array.length; i = i + 4) {
  let y = i / 4 / canvas.width;
  let x = i / 4 % canvas.width;
  array[i]   = Math.floor(255 * x / canvas.width);      // red
  array[i+1] = 128;                                                              // green
  array[i+2] = Math.floor(255 * y / canvas.height);  // blue
  array[i+3] = 255;                                                              // alpha
}
context.putImageData(imageData, 0, 0);
                                        </textarea></small>
                                        </p> 
                                        <p><small>
                                         Version avec une seule boucle
                                        </small></p>
				                </section -->

				                <section>
					                    <h2>Afficher une image</h2>
					                    <p>
					                     Lorsqu'une est fini de charger, <b>image.onload()</b> est appelée.
					                    </p>
                                        <p></p>
                                        <canvas id="canvas-image2"
                                                width="250"
                                                height="180">
                                        </canvas>
                                        <p></p>
                                        <small><textarea autojscanvas="canvas-image2" rows="9" cols="50">
let image = new Image();
function letUsDrawTheImages() {
  for(let i = 0; i < 3; i++) {
    context.drawImage(image, 10 + i * 75, 70 - i * 30);
  }
}
image.onload = letUsDrawTheImages;
image.src = "images/js-canvas/html5.png";
                                        </textarea></small>
                                        <p></p>  
				                </section>
				                <section>
					                    <h2>Afficher une image (2)</h2>
					                    <p>
					                     On peut spécifier <b>onLoad</b> en utilisant une closure,
					                     ce qui évite de devoir trouver un nom à la fonction.
					                    </p>
                                        <p></p>
                                        <canvas id="canvas-image3"
                                                width="250"
                                                height="180">
                                        </canvas>
                                        <p></p>
                                        <small><textarea autojscanvas="canvas-image3" rows="8" cols="60">
let image = new Image();
image.onload = () => {
  for(let i = 0; i < 3; i++) {
    context.drawImage(image, 10 + i * 75, 20 + Math.abs(i - 1) * 30);
  }
};
image.src = "images/js-canvas/html5.png";
                                        </textarea></small>
                                        <p><small>c'est une closure car les variables <b>context</b> et <b>image</b> sont prises du scope englobant !</small></p>  
				                </section>
				                
				                
				                
                <section>
                    <h2>&Eacute;vènements</h2>
                </section>
                <section>
                    <h2>&Eacute;vènements clavier</h2>
                    <p>
                        La fonction <b>window.addEventListener</b> permet d'enregistrer une fonction
                        qui sera appelée sur un évènement clavier d'un type donné.
                    </p>
                    <span style="float: inline-block">
                        <small><textarea autojscanvas="canvas-key" rows="11" cols="52">
let posX = 50;
function draw(color) {
  context.fillStyle = color;
  context.fillRect(posX, 100, 40, 40);
}
window.addEventListener('keydown', () => {
  draw('white');
  posX = posX + 5;
  if (posX > canvas.height) { posX = 10; }
  draw('gold');
});
                        </textarea></small>
                    </span><span style="display: inline-block">
                    <canvas id="canvas-key"
                            width="310"
                            height="210">
                    </canvas></span>
                    <p><small>Appuyer sur la touche 'a'</small></p>
                </section>
				                <section>
					                    <h2>keydow / keyup</h2>
					                    <p>
					                     <b>"keydown"</b> si on appuie sur une touche,
                                       <br/>
					                     <b>"keyup"</b> si on relâche la touche.
					                    </p>
                                        <span style="float: inline-block">
                                        <small><textarea autojscanvas="canvas-key2" rows="15" cols="52">
context.font = "16px arial";
let pos = 10;
function action(name) {
  context.fillText(name, 100, pos);
  pos = pos + 20;
  if (pos > canvas.height) {
    pos = 10;
    context.clearRect(0, 0, canvas.width, canvas.height);
  }
}
window.addEventListener("keydown",
    () => { action("key down"); });
window.addEventListener("keyup",
    () => { action("key up"); });
                                        </textarea></small>
                                        </span><span style="display: inline-block">
                                        <canvas id="canvas-key2"
                                                width="310"
                                                height="210">
                                        </canvas>
                                        </span>  
                                        <p><small>Appuyer sur la touche 'a'</small></p>
				                </section>
				                
				                <section>
					                    <h2>Récupérer les touches</h2>
					                    <p>
					                     <b>keyCode</b> permet de récupérer le code (plus ou moins ASCII) de la touche
					                    </p>
                                        <span style="float: inline-block">
                                        <small><textarea autojscanvas="canvas-key4" once="true" rows="14" cols="50">
function draw(x, color) {
  context.fillStyle = color;
  context.fillRect(x - 20, 80, 40, 40);
}
let x = 150;
draw(x, 'dodgerblue');
window.addEventListener('keydown', event => {
  draw(x, 'white');
  let key = event.keyCode;
  if (key == 84)  { x = x + 5; }              // key 'r'
  else { if (key == 82) { x = x - 5; } }  // key 't'
  draw(x, 'dodgerblue');
});
                                        </textarea></small>
                                        </span><span style="display: inline-block">
                                        <canvas id="canvas-key4"
                                                width="310"
                                                height="210">
                                        </canvas>
                                        </span>  
                                        <p><small>Utiliser les touches 'r' et 't' pour bouger le carré</small></p>
				                </section>
				                
				                <section>
					                    <h2>&Eacute;vènements souris</h2>
					                    <p>
					                     <b>onmousedown</b>, <b>onmousemove</b>, <b>onmouseup</b> sont appelées
					                     lorsque l'on utilise la souris sur un élément
					                    </p>
                                        <span style="float: inline-block">
                                        <small><textarea autojscanvas="canvas-mouse" rows="7" cols="50">
context.font = "16px arial";
context.strokeStyle = 'black';
canvas.onmousedown = event => {
  let text = event.offsetX + ', ' + event.offsetY;
  context.fillText(text, event.offsetX, event.offsetY);
};
                                        </textarea></small>
                                        </span><span style="display: inline-block">
                                        <canvas id="canvas-mouse"
                                                width="310"
                                                height="210">
                                        </canvas>
                                        </span>  
                                        <p>
                                         La fonction recoit un évènement (<b>event</b>) contenant les coordonées
					                     (<b>offsetX</b> et <b>offsetY</b>)
                                        </p>
				                </section>
				                <section>
					                    <h2>&Eacute;vènements souris (2)</h2>
					                    <p>
					                     <b>onmousemove</b> est appelée lorsque l'on bouge la souris,
					                    <br/>
					                     si l'on veut détecter si l'on bouge en appuyant,
					                    <br/> 
					                     il faut un booléen supplémentaire 
					                    </p>
                                        <span style="float: inline-block">
                                        <small><textarea autojscanvas="canvas-mouse2" rows="17" cols="45">
let drag = false;
context.strokeStyle = 'violet';
canvas.onmousedown = event => {
  drag = true;
  context.beginPath();
  context.moveTo(event.offsetX, event.offsetY);
};
canvas.onmousemove = event => {
  if (drag) {
    context.lineTo(event.offsetX, event.offsetY);
    context.stroke();
  }
};
canvas.onmouseup = () => {
  drag = false;
};
                                        </textarea></small>
                                        </span><span style="display: inline-block">
                                        <canvas id="canvas-mouse2"
                                                width="310"
                                                height="210">
                                        </canvas>
                                        </span>  
                                        <p><small></small></p>
				                </section>
				                
                                <section>
					                    <h2>setTimeout</h2>
					                    <p>
					                     <b>setTimeout(action, temps)</b> permet de déclencher
					                     une action après un temps d'attente (en ms)
					                    </p>
                                        <p></p>
                                        <canvas id="canvas-timer"
                                                width="300"
                                                height="200">
                                        </canvas>
                                        <p></p>
                                        <small><textarea autojscanvas="canvas-timer" rows="7" cols="35">
context.fillStyle = "red";
context.fillRect(100, 50, 100, 100);
window.setTimeout(() => {
  context.fillStyle = "lightblue";
  context.fillRect(100, 50, 100, 100);
}, 5000);
                                        </textarea></small>
                                        <p></p>  
				                </section>
				                <section>
					                    <h2>setTimeout (2)</h2>
					                    <p>
					                     on peut appeler <b>setTimeout()</b> plusieurs fois avec la même fonction
					                    </p>
                                        <span style="float: inline-block">
                                        <small><textarea autojscanvas="canvas-timer2" rows="10" cols="35">
let colors = [ 'red', 'lightblue' ];
let index = 0;
let fun = () => {
  context.fillStyle = colors[index];
  context.fillRect(100, 50, 100, 100);
  index = 1 - index;
  window.setTimeout(fun, 2000);
};
fun();
                                        </textarea></small>
                                        </span><span style="display: inline-block">
                                        <canvas id="canvas-timer2"
                                                width="300"
                                                height="200">
                                        </canvas>
                                        </span>  
                                        <p>&nbsp;</p>
				                </section>
				                
				                <section>
					                    <h2>setInterval</h2>
					                    <p>
					                     <b>window.setInterval</b> permet de rappeler une fonction
					                     à intervalles réguliers
					                    </p>
                                        <span style="float: inline-block">
                                        <small><textarea autojscanvas="canvas-timer3" rows="14" cols="40">
function draw(color) {
  context.fillStyle = color;
  context.fillRect(x - 5, y - 5, 10, 10);
}
let x = 0; let y = 0; let dx = 1; let dy = 1;
let animate = () => {
  draw('white');
  x = x + dx; y = y + dy;
  if (x == 0 || x == canvas.width) { dx = -dx; }
  if (y == 0 || y == canvas.height) { dy = -dy; }
  draw('red');
};
window.setInterval(animate, 12);
                                        </textarea></small>
                                        </span><span style="display: inline-block">
                                        <canvas id="canvas-timer3"
                                                width="310"
                                                height="210">
                                        </canvas>
                                        </span>  
                                        <p>&nbsp;</p>
				                </section>
				                
				                <section>
					                    <h2>requestAnimationFrame</h2>
					                    <p>
					                     demande une animation dès que possible         
					                    </p>
                                        <span style="float: inline-block">
                                        <small><textarea autojscanvas="canvas-timer4" once="true" rows="21" cols="50">
function point(x, y) { return { x: x, y: y, dx: 1, dy: 1 }; }
function draw(p1, p2, color) {
  context.strokeStyle = color;
  context.beginPath();
  context.moveTo(p1.x, p1.y); context.lineTo(p2.x, p2.y);
  context.stroke();
}
let move = p => {
  p.x = p.x + p.dx; p.y = p.y + p.dy;
  if (p.x == 0 || p.x == canvas.width) { p.dx = -p.dx; }
  if (p.y == 0 || p.y == canvas.height) { p.dy = -p.dy; }
};
let p1 = point(50, 50);  let p2 = point(200, 150);
let animate = () => {
  draw(p1, p2, 'white');
  move(p1); move(p2);
  draw(p1, p2, 'blue');
  window.requestAnimationFrame(animate);
};
window.requestAnimationFrame(animate);
                                        </textarea></small>
                                        </span><span style="display: inline-block">
                                        <canvas id="canvas-timer4"
                                                width="310"
                                                height="210">
                                        </canvas>
                                        </span>  
                                        <p>&nbsp;</p>
				                </section>
				                
				                
				                
			</div>

		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                                        { src: 'plugin/autoeval/autoeval.js', async: true },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
